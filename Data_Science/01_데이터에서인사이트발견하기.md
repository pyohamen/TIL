# 01_데이터에서 인사이트 발견하기

> 우리는 왜 데이터를 분석하려고 할까? 바로 문제해결을 위한 Insight 를 얻기 위해서

## 1.1 탐색적 데이터 분석의 과정

> 데이터 분석의 기본인 EDA (Exploratory Data Analysis)

### 1. 탐색 ( 데이터의 기초 정보 살펴보기 )

1. 데이터의 출처와 주제에 대해 이해

2. 데이터의 크기 확인

3. 데이터의 구성 요소 (피처) 살펴보기

   - 피처: 데이터를 구성하는 요소

     ![스크린샷 2020-12-12 오전 4.15.39](../images/picher.png)



### 2. 인사이트 발견

- 피처의 속성 탐색

  ![스크린샷 2020-12-12 오전 4.16.48](../images/pichersearch.png)

- 피처 간의 상관 관계 탐색



### 3. 탐색한 데이터의 시각화

![스크린샷 2020-12-12 오전 4.17.36](../images/Visupicher.png)



## 1.2 멕시코풍 프랜차이즈 chipotle 의 주문 데이터 분석하기

> 주문데이터를 불러와
>
> 기초정보 살펴보고
>
> 탐색 / 시각화를 수행해보고
>
> 이 예제로 전처리를 해보고
>
> 이런저런 인사이트를 살펴보자

### Step 1. 탐색: 데이터의 기초 정보 살펴보기

- 불러오기

  ```python
  import pandas as pd
  file_path = '../data/chipotle.tsv'
  chipo = pd.read_csv(file_path, sep='\t') # chipo 는 Datafram 객체가 된다.
  ```

- 정보확인

  ```python
  print(chipo.shape) # (행수, 열수)
  chipo.info() # df 의 정보들 표출
  chipo # 테이블 형태로 보여줌
  chipo['item_name'] / chipo.item_name # 이 둘은 Series 객체가 된다. 해당 피처의 값들
  ```

- 수치적 특성들 파악

  ```python
  print(chipo.describe()) # 이런저런 통계량들을 보여줌
  print(len(chipo['item_name'].unique())) # item_name 피처의 유일값 series 의 길이를 출력
  ```

  

### Step2. 인사이트의 발견: 탐색과 시각화

- 가장 많이 주문한 item top 10

  ```python
  item_count = chipo['item_name'].value_counts()
  
  for idx, (val, cnt) in enumerate(item_count.iteritems(), 1): # iteritems 는 series 를 (idx, val) 튜플로 "하나씩" 반환함
    print("Top", idx, ":", val, cnt)
    
  ```

- Item 당 주문 개수 / 

  ```python
  order_count = chipo.groupby('item_name')['order_id'].count() # item_name 별로 묶어서 주문개수를 샌 것
  item_quantity = chipo.groupby('item_name')['quantity'].sum() # item_name 별로 묶어서 총량들을 모두 더한 것
  ```

- 아이템당 주문개수 시각화

  ```python
  %matplotlib inline # matplot 쥬피터에서 쓴다는 선언
  import numpy as np
  import matplotlib.pyplot as plt
  
  item_name_list = item_quantity.index.tolist() # x 축에 들어갈 상품 인덱스
  
  x_pos = np.arange(len(item_name_list))
  order_cnt = item_quantity.values.tolist()
  
  Plt.bar(x_pos, order_cnt, align='center')
  plt.ylabel('order_item_count')
  plt.title('Distribution of all orderd item')
  
  plt.show()
  ```

  ![스크린샷 2020-12-22 오전 12.48.11](../images/pltshow1st.png)

### Step3. 데이터 전처리

- Item_price 피처가 $--- 인 object 이기 때문에, $를 없앤 int64 로 바꿔주자

  ```python
  chipo['item_price'] = chipo['item_price'].apply(lambda x: float(x[1:]))
  ```



### Step4. 이런저런 인사이트

- 주문당 평균 계산금액

  ```python
  chipo.groupyby('order_id')['item_price'].sum().mean()
  ```

- 한 주문에 10달러 이상 사용한 주문 번호 출력

  ```python
  chipo_orderid_group = chipo.groupby('order_id').sum()
  
  results = chipo_orderid_group[chipo_orderid_group.item_price >= 10] # pandas 에서 이런식으로 조건문 인덱싱 가능
  ```

- 각 아이템의 가격 구하기

  ```python
  chipo_one_item = chipo[chipo.quantity == 1]
  price_per_item = chipo_one_item.groupby('item_name').min()
  price_per_item.sort_values(by = "item_price", ascending = False)[:10]
  ```

- 아이템 가격 분포 그래프 출력

  ```python
  item_name_list = price_per_item.index.tolist()
  x_pos = np.arange(len(item_name_list))
  item_price = price_per_item['item_price'].tolist()
  
  plt.bar(x_pos, item_price, align='center')
  plt.ylabel('item price($)')
  plt.title('Distribution of item price')
  
  plt.show()
  ```

- 아이템 가격 히스토그램

  ```python
  item_name_list =. rice_per_item.index.tolist()
  x_pos =. p.arange(len(item_name_list))
  item_price =. rice_per_item['item_price'].tolist()
  
  plt.bar(x_pos, item_price, align='center')
  plt.ylabel('item price($)')
  plt.title('Distribution of. tem price')
  
  plt.show()
  ```

- 가장 비싼 주문에서 아이템의 개수가 몇개인지

  ```python
  chipo.groupby('order_id').sum().sort_values(by='item_price', ascending=False)
  ```

- "Veggie Salad Bowl" 이 몇 번 주문되었는지 확인

  ```python
  chipo_salad = chipo[chipo['item_name'] == "Veggie Salad Bowl"]
  chipo_salad = chipo_salad.drop_duplicates(['item_name', 'order_id']) # item_name과 order_id 가 같은 행들을 없애준다.
  ```

- Chicken Bowl 을 2개 이상 주문한 주문 횟수 수하기

  ```
  
  ```

  

