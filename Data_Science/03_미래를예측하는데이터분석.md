# 03 미래를 예측하는 데이터 분석

> 예측분석
>
> ​	데이터를 분석해 특정결과를 미리 예측해보는 것



# 핵심개념

1. 지도 학습과 비지도 학습의 개념을 이해
2. 회귀 분석으로 예측을 수행
3. 시계열 데이터의 트랜드를 예측
4. 수학적 기법을 활용하여 평점을 예측



# 3.1 프로야구 선수의 다음 해 연봉 예측 (회귀분석)

> 예측 분석의 가장 대표적인 **회귀분석**
> 	y = w1 * X1 + w2 * X2 + ... + b 를 구하자
>
> 이미 y 를 알고 있는 **학습 전용 데이터셋** / 그게 아닌 **테스트 전용 데이터셋** 이 있고, 이러한 학습 방식이 **지도학습**

## <step 1> 탐색: 프로야구 연봉 데이터 살펴보기

1. 히스토그램과 상자그림 (Box Plot) 으로 살펴보자
   - 상자 그림은 사분위값 특성으로 데이터의 분포를 파악하며, 일반적인 범주를 벗어나는 데이터를 파악할 수 있다. [wiki](https://ko.wikipedia.org/wiki/%EC%83%81%EC%9E%90_%EC%88%98%EC%97%BC_%EA%B7%B8%EB%A6%BC)

## <step 2> 예측: 투수의 연봉 예측하기

1. 각 피처간 범위가 다르니 피처의 정규화 / **피처 스케일링**을 수행
   - 표준화: ( (X) - (X 의 평균) / X 의 표준편차 )
   - 연속형이 아닌 피처는 **원-핫 인코딩** 으로 벡터로 바꿔줌
2. 학습 데이터셋과 테스크 데이터셋으로 데이터 분리
3. 회귀 분석 계수 학습 & 학습된 계수 출력

## <step 3> 평가: 예측 모델 평가하기

1. Statsmodel 라이브러리의 OLS 클래스의 summary() 함수를 이용하면 계수의 대한 분석과 결정계수 (R-squared), 혹은 수정결정계수 (Adj. R-squared) 를 알 수 있으며 이는 '회귀분석으로 추정한 모델이 주어진 데이터를 얼마나 잘 설명하는가' 에 대한 점수며 1 에 가까울수록 잘 설명함

2. F-value 와 F-value 의 p-value 인 Prob 수치 관찰 

3. 학습데이터셋과 테스트 데이터셋에 대한 수정 결정계수를 관찰

   - 벌어지지 않는게 좋으며, 학습 점수가 테스트에 비해 높다면 과적함 (overfit) 임

4. RMSE (Root Mean Square Error) score 로도 회귀 모델 평가

   - 실제값과 예측값의 차이를 절대적인 수치로 나타낸 것. 당연히 높을수록 부정확
   - 이 또한 train 과 test 를 나눠 볼 수 있다.

5. 다중 공선성 관찰

   > 회귀분석은 피처 간의 '독립성'이 전제. 변수 간 상관 관계가 높다면 회귀분석에 부정적인 영향

   - 분산팽창요인 (VIF, Variance Inflation Factor) 계수로 평가. 일반적으로 10 ~ 15 를 넘으면 다중 공선성의 문제 발생

## <step 4> 시각화: 분석 결과 시각화

선수마다 작년연봉, 예측연봉, 실제연봉을 보여주자

## 정리

| 주요 키워드        | 핵심 내용                                     | 설명                                                         |
| ------------------ | --------------------------------------------- | ------------------------------------------------------------ |
| 데이터의 분리      | 학습 전용 데이터셋과 테스트전용 데이터셋 분리 | 회귀 분석 모델을 학습 전용 데이터셋으로 나누어 학습하고, 이를 테스트전용 데이터셋으로 평가. 이 과정을 지도 학습 |
| 피처의 정규화      | 데이터의 피처 스케일링                        | 피처 간의 단위를 맞춰주는 피처 스케일링 작업 수행            |
| 범주형 피처의 변환 | 원-핫 인코딩                                  | 연산 불가능한 범주형 피처를 연산 가능한 벡터 형태의 피처로 변환 |
| 회귀 분석의 평가   | R2 score, RMSE score                          | R2 score, RMSE score 등의 평가 지표를 통해 회귀 분석이 얼마나 잘 되었는지 평가 |
| 다중 공선성 분석   | 피처 간의 독립성 검정                         | VIF 계수를 통해 피처 간의 다중 공선성 문제를 검증            |



# 3.2 비트코인 시세 예측하기 (시계열 데이터 분석)

> 연속적인 시간에 따라 다르게 측정되는 데이터를 분석해보자.
> 	규칙적 시계열 데이터와 비규칙적 시계열 데이터가 있다.

